!function(e){var t,s=e.each,r=e.pick,n=HighchartsAdapter.inArray,i=e.splat,o=function(e,t){this.init(e,t)};e.extend(o.prototype,{init:function(e,t){this.options=e,this.chartOptions=t,this.columns=e.columns||this.rowsToColumns(e.rows)||[],this.firstRowAsNames=r(e.firstRowAsNames,!0),this.decimalRegex=e.decimalPoint&&RegExp("^([0-9]+)"+e.decimalPoint+"([0-9]+)$"),this.rawColumns=[],this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var r,n=this.chartOptions,i=this.options,o=[],a=function(t){return(e.seriesTypes[t||"line"].prototype.pointArrayMap||[0]).length},l=n&&n.chart&&n.chart.type,u=[],h=[],m=0;s(n&&n.series||[],function(e){u.push(a(e.type||l))}),s(i&&i.seriesMapping||[],function(e){o.push(e.x||0)}),0===o.length&&o.push(0),s(i&&i.seriesMapping||[],function(s){var i,o=new t,d=u[m]||a(l),p=e.seriesTypes[((n&&n.series||[])[m]||{}).type||l||"line"].prototype.pointArrayMap||["y"];o.addColumnReader(s.x,"x");for(i in s)s.hasOwnProperty(i)&&"x"!==i&&o.addColumnReader(s[i],i);for(r=0;d>r;r++)o.hasReader(p[r])||o.addColumnReader(void 0,p[r]);h.push(o),m++}),i=e.seriesTypes[l||"line"].prototype.pointArrayMap,void 0===i&&(i=["y"]),this.valueCount={global:a(l),xColumns:o,individual:u,seriesBuilders:h,globalPointArrayMap:i}},dataFound:function(){this.options.switchRowsAndColumns&&(this.columns=this.rowsToColumns(this.columns)),this.getColumnDistribution(),this.parseTypes(),this.parsed()!==!1&&this.complete()},parseCSV:function(){var e,t,r=this,n=this.options,i=n.csv,o=this.columns,a=n.startRow||0,l=n.endRow||Number.MAX_VALUE,u=n.startColumn||0,h=n.endColumn||Number.MAX_VALUE,m=0;i&&(t=i.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(n.lineDelimiter||"\n"),e=n.itemDelimiter||(-1!==i.indexOf("	")?"	":","),s(t,function(t,n){var i=r.trim(t),d=0===i.indexOf("#");n>=a&&l>=n&&!d&&""!==i&&(i=t.split(e),s(i,function(e,t){t>=u&&h>=t&&(o[t-u]||(o[t-u]=[]),o[t-u][m]=e)}),m+=1)}),this.dataFound())},parseTable:function(){var e=this.options,t=e.table,r=this.columns,n=e.startRow||0,i=e.endRow||Number.MAX_VALUE,o=e.startColumn||0,a=e.endColumn||Number.MAX_VALUE;t&&("string"==typeof t&&(t=document.getElementById(t)),s(t.getElementsByTagName("tr"),function(e,t){t>=n&&i>=t&&s(e.children,function(e,s){("TD"===e.tagName||"TH"===e.tagName)&&s>=o&&a>=s&&(r[s-o]||(r[s-o]=[]),r[s-o][t-n]=e.innerHTML)})}),this.dataFound())},parseGoogleSpreadsheet:function(){var e,t,s=this,r=this.options,n=r.googleSpreadsheetKey,i=this.columns,o=r.startRow||0,a=r.endRow||Number.MAX_VALUE,l=r.startColumn||0,u=r.endColumn||Number.MAX_VALUE;n&&jQuery.ajax({dataType:"json",url:"https://spreadsheets.google.com/feeds/cells/"+n+"/"+(r.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",error:r.error,success:function(r){var n,h,r=r.feed.entry,m=r.length,d=0,p=0;for(h=0;m>h;h++)n=r[h],d=Math.max(d,n.gs$cell.col),p=Math.max(p,n.gs$cell.row);for(h=0;d>h;h++)h>=l&&u>=h&&(i[h-l]=[],i[h-l].length=Math.min(p,a-o));for(h=0;m>h;h++)n=r[h],e=n.gs$cell.row-1,t=n.gs$cell.col-1,t>=l&&u>=t&&e>=o&&a>=e&&(i[t-l][e-o]=n.content.$t);s.dataFound()}})},trim:function(e,t){return"string"==typeof e&&(e=e.replace(/^\s+|\s+$/g,""),t&&/^[0-9\s]+$/.test(e)&&(e=e.replace(/\s/g,"")),this.decimalRegex&&(e=e.replace(this.decimalRegex,"$1.$2"))),e},parseTypes:function(){for(var e=this.columns,t=e.length;t--;)this.parseColumn(e[t],t)},parseColumn:function(e,t){var s,r,o,a,l,u=this.rawColumns,h=this.columns,m=e.length,d=this.firstRowAsNames,p=-1!==n(t,this.valueCount.xColumns),c=[],f=this.chartOptions,g=(this.options.columnTypes||[])[t],f=p&&(f&&f.xAxis&&"category"===i(f.xAxis)[0].type||"string"===g);for(u[t]||(u[t]=[]);m--;)s=c[m]||e[m],o=this.trim(s),a=this.trim(s,!0),r=parseFloat(a),void 0===u[t][m]&&(u[t][m]=o),f||0===m&&d?e[m]=o:+a===r?(e[m]=r,r>31536e6&&"float"!==g?e.isDatetime=!0:e.isNumeric=!0,void 0!==e[m+1]&&(l=r>e[m+1])):(r=this.parseDate(s),p&&"number"==typeof r&&!isNaN(r)&&"float"!==g?(c[m]=s,e[m]=r,e.isDatetime=!0,void 0!==e[m+1]&&(s=r>e[m+1],s!==l&&void 0!==l&&(this.alternativeFormat?(this.dateFormat=this.alternativeFormat,m=e.length,this.alternativeFormat=this.dateFormats[this.dateFormat].alternative):e.unsorted=!0),l=s)):(e[m]=""===o?null:o,0!==m&&(e.isDatetime||e.isNumeric)&&(e.mixed=!0)));if(p&&e.mixed&&(h[t]=u[t]),p&&l&&this.options.sort)for(t=0;t<h.length;t++)h[t].reverse(),d&&h[t].unshift(h[t].pop())},dateFormats:{"YYYY-mm-dd":{regex:/^([0-9]{4})[\-\/\.]([0-9]{2})[\-\/\.]([0-9]{2})$/,parser:function(e){return Date.UTC(+e[1],e[2]-1,+e[3])}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(e){return Date.UTC(+e[3],e[2]-1,+e[1])},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(e){return Date.UTC(+e[3],e[1]-1,+e[2])}},"dd/mm/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(e){return Date.UTC(+e[3]+2e3,e[2]-1,+e[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(e){return Date.UTC(+e[3]+2e3,e[1]-1,+e[2])}}},parseDate:function(e){var t,s,r,n=this.options.parseDate,i=this.options.dateFormat||this.dateFormat;if(n)t=n(e);else if("string"==typeof e){if(i)n=this.dateFormats[i],(r=e.match(n.regex))&&(t=n.parser(r));else for(s in this.dateFormats)if(n=this.dateFormats[s],r=e.match(n.regex)){this.dateFormat=s,this.alternativeFormat=n.alternative,t=n.parser(r);break}r||(r=Date.parse(e),"object"==typeof r&&null!==r&&r.getTime?t=r.getTime()-6e4*r.getTimezoneOffset():"number"==typeof r&&!isNaN(r)&&(t=r-6e4*new Date(r).getTimezoneOffset()))}return t},rowsToColumns:function(e){var t,s,r,n,i;if(e)for(i=[],s=e.length,t=0;s>t;t++)for(n=e[t].length,r=0;n>r;r++)i[r]||(i[r]=[]),i[r][t]=e[t][r];return i},parsed:function(){return this.options.parsed?this.options.parsed.call(this,this.columns):void 0},getFreeIndexes:function(e,t){var s,r,n,i=[],o=[];for(r=0;e>r;r+=1)i.push(!0);for(s=0;s<t.length;s+=1)for(n=t[s].getReferencedColumnIndexes(),r=0;r<n.length;r+=1)i[n[r]]=!1;for(r=0;r<i.length;r+=1)i[r]&&o.push(r);return o},complete:function(){var e,s,r,i,o,a,l=this.columns,u=this.options,h=[];if(u.complete||u.afterComplete){for(i=0;i<l.length;i++)this.firstRowAsNames&&(l[i].name=l[i].shift());for(s=[],r=this.getFreeIndexes(l.length,this.valueCount.seriesBuilders),i=0;i<this.valueCount.seriesBuilders.length;i++)a=this.valueCount.seriesBuilders[i],a.populateColumns(r)&&h.push(a);for(;r.length>0;){for(a=new t,a.addColumnReader(0,"x"),i=n(0,r),-1!==i&&r.splice(i,1),i=0;i<this.valueCount.global;i++)a.addColumnReader(void 0,this.valueCount.globalPointArrayMap[i]);a.populateColumns(r)&&h.push(a)}if(h.length>0&&h[0].readers.length>0&&(a=l[h[0].readers[0].columnIndex],void 0!==a&&(a.isDatetime?e="datetime":a.isNumeric||(e="category"))),"category"===e)for(i=0;i<h.length;i++)for(a=h[i],r=0;r<a.readers.length;r++)"x"===a.readers[r].configName&&(a.readers[r].configName="name");for(i=0;i<h.length;i++){for(a=h[i],r=[],o=0;o<l[0].length;o++)r[o]=a.read(l,o);s[i]={data:r},a.name&&(s[i].name=a.name),"category"===e&&(s[i].turboThreshold=0)}l={series:s},e&&(l.xAxis={type:e}),u.complete&&u.complete(l),u.afterComplete&&u.afterComplete(l)}}}),e.Data=o,e.data=function(e,t){return new o(e,t)},e.wrap(e.Chart.prototype,"init",function(t,s,r){var n=this;s&&s.data?e.data(e.extend(s.data,{afterComplete:function(i){var o,a;if(s.hasOwnProperty("series"))if("object"==typeof s.series)for(o=Math.max(s.series.length,i.series.length);o--;)a=s.series[o]||{},s.series[o]=e.merge(a,i.series[o]);else delete s.series;s=e.merge(i,s),t.call(n,s,r)}}),s):t.call(n,s,r)}),t=function(){this.readers=[],this.pointIsArray=!0},t.prototype.populateColumns=function(e){var t=!0;return s(this.readers,function(t){void 0===t.columnIndex&&(t.columnIndex=e.shift())}),s(this.readers,function(e){void 0===e.columnIndex&&(t=!1)}),t},t.prototype.read=function(e,t){var r,n=this.pointIsArray,i=n?[]:{};return s(this.readers,function(s){var r=e[s.columnIndex][t];n?i.push(r):i[s.configName]=r}),void 0===this.name&&this.readers.length>=2&&(r=this.getReferencedColumnIndexes(),r.length>=2)&&(r.shift(),r.sort(),this.name=e[r.shift()].name),i},t.prototype.addColumnReader=function(e,t){this.readers.push({columnIndex:e,configName:t}),"x"!==t&&"y"!==t&&void 0!==t&&(this.pointIsArray=!1)},t.prototype.getReferencedColumnIndexes=function(){var e,t,s=[];for(e=0;e<this.readers.length;e+=1)t=this.readers[e],void 0!==t.columnIndex&&s.push(t.columnIndex);return s},t.prototype.hasReader=function(e){var t,s;for(t=0;t<this.readers.length;t+=1)if(s=this.readers[t],s.configName===e)return!0}}(Highcharts);