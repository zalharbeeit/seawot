!function(o){"use strict";o.fn.bPopup=function(t,n){function e(){b(k.onOpen),F=(L.data("bPopup")||0)+1,T=E+F+"__",x="auto"!==k.position[1],v="auto"!==k.position[0],P="fixed"===k.positionStyle,S=W.outerHeight(!0),z=W.outerWidth(!0),k.loadUrl?i():a()}function i(){switch(k.contentContainer=o(k.contentContainer||W),k.content){case"iframe":var t=o('<iframe class="b-iframe" '+k.iframeAttr+"></iframe>");t.appendTo(k.contentContainer),S=W.outerHeight(!0),z=W.outerWidth(!0),a(),t.attr("src",k.loadUrl),b(k.loadCallback);break;case"image":a(),o("<img />").load(function(){b(k.loadCallback),d(o(this))}).attr("src",k.loadUrl).hide().appendTo(k.contentContainer);break;default:a(),o('<div class="b-ajax-wrapper"></div>').load(k.loadUrl,k.loadData,function(t,n){b(k.loadCallback,n),d(o(this))}).hide().appendTo(k.contentContainer)}}function a(){k.modal&&o('<div class="b-modal '+T+'"></div>').css({backgroundColor:k.modalColor,position:"fixed",top:0,right:0,bottom:0,left:0,opacity:0,zIndex:k.zIndex+F}).appendTo(k.appendTo).fadeTo(k.speed,k.opacity),w(),W.data("bPopup",k).data("id",T).css({left:"slideIn"==k.transition||"slideBack"==k.transition?"slideBack"==k.transition?_.scrollLeft()+A:-1*(I+z):p(!(!k.follow[0]&&v||P)),position:k.positionStyle||"absolute",top:"slideDown"==k.transition||"slideUp"==k.transition?"slideUp"==k.transition?_.scrollTop()+j:U+-1*S:h(!(!k.follow[1]&&x||P)),"z-index":k.zIndex+F+1}).each(function(){k.appending&&o(this).appendTo(k.appendTo)}),u(!0)}function l(){return k.modal&&o(".b-modal."+W.data("id")).fadeTo(k.speed,0,function(){o(this).remove()}),r(),clearTimeout(H),u(),!1}function s(t){j=g(),A=C(),y=m(),(y.x||y.y)&&(clearTimeout(B),B=setTimeout(function(){w(),t=t||k.followSpeed;var n={};y.x&&(n.left=k.follow[0]?p(!0):"auto"),y.y&&(n.top=k.follow[1]?h(!0):"auto"),W.dequeue().each(function(){P?o(this).css({left:I,top:U}):o(this).animate(n,t,k.followEasing)})},50))}function d(o){var t=o.width(),n=o.height(),e={};k.contentContainer.css({height:n,width:t}),n>=W.height()&&(e.height=W.height()),t>=W.width()&&(e.width=W.width()),S=W.outerHeight(!0),z=W.outerWidth(!0),w(),k.contentContainer.css({height:"auto",width:"auto"}),e.left=p(!(!k.follow[0]&&v||P)),e.top=h(!(!k.follow[1]&&x||P)),W.animate(e,250,function(){o.show(),y=m()})}function c(){L.data("bPopup",F),W.delegate(".bClose, ."+k.closeClass,"click."+T,l),k.modalClose&&o(".b-modal."+T).css("cursor","pointer").bind("click",l),O||!k.follow[0]&&!k.follow[1]||L.bind("scroll."+T,function(){if(y.x||y.y){var o={};y.x&&(o.left=k.follow[0]?p(!P):"auto"),y.y&&(o.top=k.follow[1]?h(!P):"auto"),W.dequeue().animate(o,k.followSpeed,k.followEasing)}}).bind("resize."+T,function(){s()}),k.escClose&&_.bind("keydown."+T,function(o){27==o.which&&l()})}function r(){k.scrollBar||o("html").css("overflow","auto"),o(".b-modal."+T).unbind("click"),_.unbind("keydown."+T),L.unbind("."+T).data("bPopup",L.data("bPopup")-1>0?L.data("bPopup")-1:null),W.undelegate(".bClose, ."+k.closeClass,"click."+T,l).data("bPopup",null)}function u(o){function t(t){W.css({display:"block",opacity:1}).animate(t,k.speed,k.easing,function(){f(o)})}switch(o?k.transition:k.transitionClose||k.transition){case"slideIn":t({left:o?p(!(!k.follow[0]&&v||P)):_.scrollLeft()-(z||W.outerWidth(!0))-q});break;case"slideBack":t({left:o?p(!(!k.follow[0]&&v||P)):_.scrollLeft()+A+q});break;case"slideDown":t({top:o?h(!(!k.follow[1]&&x||P)):_.scrollTop()-(S||W.outerHeight(!0))-q});break;case"slideUp":t({top:o?h(!(!k.follow[1]&&x||P)):_.scrollTop()+j+q});break;default:W.stop().fadeTo(k.speed,o?1:0,function(){f(o)})}}function f(o){o?(c(),b(n),k.autoClose&&(H=setTimeout(l,k.autoClose))):(W.hide(),b(k.onClose),k.loadUrl&&(k.contentContainer.empty(),W.css({height:"auto",width:"auto"})))}function p(o){return o?I+_.scrollLeft():I}function h(o){return o?U+_.scrollTop():U}function b(t,n){o.isFunction(t)&&t.call(W,n)}function w(){U=x?k.position[1]:Math.max(0,(j-W.outerHeight(!0))/2-k.amsl),I=v?k.position[0]:(A-W.outerWidth(!0))/2,y=m()}function m(){return{x:A>W.outerWidth(!0),y:j>W.outerHeight(!0)}}function g(){return L.height()}function C(){return L.width()}o.isFunction(t)&&(n=t,t=null);var k=o.extend({},o.fn.bPopup.defaults,t);k.scrollBar||o("html").css("overflow","hidden");var T,y,x,v,P,U,I,S,z,B,H,W=this,_=o(document),D=window,L=o(D),j=g(),A=C(),E="__b-popup",O=/OS 6(_\d)+/i.test(navigator.userAgent),q=200,F=0;return W.close=function(){l()},W.reposition=function(o){s(o)},W.each(function(){o(this).data("bPopup")||e()})},o.fn.bPopup.defaults={amsl:50,appending:!0,appendTo:"body",autoClose:!1,closeClass:"b-close",content:"ajax",contentContainer:!1,easing:"swing",escClose:!0,follow:[!0,!0],followEasing:"swing",followSpeed:500,iframeAttr:'scrolling="no" frameborder="0"',loadCallback:!1,loadData:!1,loadUrl:!1,modal:!0,modalClose:!0,modalColor:"#000",onClose:!1,onOpen:!1,opacity:.7,position:["auto","auto"],positionStyle:"absolute",scrollBar:!0,speed:250,transition:"fadeIn",transitionClose:!1,zIndex:9997}}(jQuery);